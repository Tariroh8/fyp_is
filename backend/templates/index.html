{% load static %}
{% load leaflet_tags %}
{% load geojson_tags %}



<html>
    <head>
        {% leaflet_js %}
        {% leaflet_css %}
        <style type='text/css'>
            #map  { width: 100%;  height:100%;}
        </style>
        
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Animal information system</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet", href = "{% static 'css/main.css' %}">

    <link rel="stylesheet", href = "{% static 'css/main.css' %}">

    </head>
<body>
{% include "navbar.html" %}

<div class="d-flex" style="height: 200px;">
    <div class="vr"></div>
    <div>
        <div>
            <h5>Select a District</h5>
            <div class="district-list">
                <ul class="list-group">
                    {% for district in districts %}
                    <li class="list-group-item"><a href="{{ district.name_2 }}">{{ district.name_2 }}</a></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>


<div class="all-districts">
    <div id="map"></div>

    <script>
        var districts = {{ serialized_districts|safe }};
        var cases = {{ serialized_cases|safe }};
        var hoverPopup = L.popup({
            closeButton: false,
            autoClose: false
          });
    
        var map = L.map('map').setView([-17, 30.8], 6);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);
    
        var hoverPopup = L.popup({
            closeButton: false,
            autoClose: false
        });
    
        L.geoJSON(districts, {
            onEachFeature: function (feature, layer) {
                layer.on('mouseover', function (e) {
                    var districtName = feature.properties.name_2;
                    hoverPopup.setLatLng(e.latlng).setContent(districtName).openOn(map);
                });
    
                layer.on('mouseout', function (e) {
                    hoverPopup.remove();
                });
            }
        }).addTo(map);

        L.geoJSON(cases, {
            pointToLayer: function (feature, latlng) {
                var redMarker = L.circleMarker(latlng, {
                    radius: 2, // Change the size of the marker here
                    fillColor: 'red', // Change the color of the marker here
                    color: 'red',
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                });
                return redMarker;
            },
            onEachFeature: function (feature, layer) {
                var animalType = feature.properties.spicies;
                layer.bindPopup(animalType);
            }
        }).addTo(map);
    </script>
    <script type= "text/javascript" src= "{% static 'js/main.js' %}"></script>
    
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script> 


</body>

</html> 
 
